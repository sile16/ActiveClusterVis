<!DOCTYPE html>
<html lang="en">
<head>
    
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>State Machine Interface</title>
<script src="network.js"></script>
<script src="fa.js"></script>
<script src="site.js"></script>
<script src="vmware.js"></script>
<script src="ac.js"></script>
<script src="cvis.js"></script>
<script src="https://unpkg.com/cytoscape@3.17.2/dist/cytoscape.min.js"></script>

<style>
    #output {
        margin-top: 20px;
        border: 1px solid #ccc;
        padding: 10px;
    }
    #cy {
        width: 100%;
        height: 600px;  /* Set a fixed height */
        position: relative;
    }
</style>
</head>
<body>

    <h1>Active Cluster Simulator</h1>
    <!--Add WAN Latency Input-->
    <label for="wanlatency">WAN Latency RTT (ms):</label>
    <input oninput="site.setWANLatency(this.value)" type="text" id="wanlatency" name="wanlatency" value="3">


    <button onclick="site.addRepCrossover();step()">Add Replication Switch Crossover</button>
    <button onclick="site.addFCCrossover();step()">Add Uniform Connections</button>
    <button onclick="site.setPreferredArray();step()">Set Preferred Array in Host Entry</button>
    <button onclick="site.setPodFailoverPreference(document.getElementById('podfailover').value);step()">Set Pod Failover Preference</button>
    <select id="podfailover">
        <option value="none">None</option>
        <option value="site1fa1">site1fa1</option>
        <option value="site2fa1">site2fa1</option>
    </select>
    <button onclick="site.enableAPDPDL()">Enable VMWare APD/PDL</button>
    
    
    <br><br>
    

<label for="events">Mouse Click Event:</label>
<select id="events">
    <!-- Common events can remain hardcoded or be dynamically generated as well -->
    <option value="fail">Fail</option>
    <option value="recover">Recover</option>
    <option value="promote">Promote (FA Controllers Only)</option>
    <option value="power_on">Power On (VM Only)</option>
    <option value="power_off">Power Off (VM Only)</option>
    <option value="reboot">Reboot (VM Only)</option>
</select> add step after click <input type="checkbox" id="clickstep" name="step" value="step" checked>
<button onclick="step()">Step</button>
<br><br>

<div id="cy"></div>

<script>
    let site;

    function initializeSite() {
        site = new MultiSite("Test Site", document.getElementById('wanlatency').value);
        updateVisualization(site);  // Add this line
        //do 1 step to initialize the site
        site.fullStep();
        updateVisualization(site);  // Add this line
        site.fullStep();
        updateVisualization(site);  // Add this line
        site.fullStep();
        updateVisualization(site);  // Add this line
        site.fullStep();
        updateVisualization(site);  // Add this line
        
        //console.log("site initialized");
        //updateOutput("Site Initialized");
    }

    function step() {
        site.fullStep();
        updateVisualization(site);  // Add this line
        //console.log("Step Executed");
    }

    

document.addEventListener('DOMContentLoaded', function() {
    initializeSite();
    
});

</script>

</body>
</html>
